---
:id: 384
:name: Rudin-Shapiro sequence
:url: http://projecteuler.net/problem=384
:content: "\r\n<p>Define the sequence a(n) as the number of adjacent pairs of ones
  in the binary expansion of n (possibly overlapping).\r\n<br>E.g.: a(5) = a(101<sub>2</sub>)
  = 0, a(6) = a(110<sub>2</sub>) = 1, a(7) = a(111<sub>2</sub>) = 2</p>\r\n\r\n<p>Define
  the sequence b(n) = (-1)<sup>a(n)</sup>.\r\n<br>This sequence is called the <b>Rudin-Shapiro</b>
  sequence.</p>\r\n<p>Also consider the summatory sequence of b(n): <img src=\"project/images/p_384_formula.gif\"
  style=\"margin-top:-9px;\">.</p>\r\n\r\n<p>The first couple of values of these sequences
  are:\r\n<br><tt>n    &amp;nbsp   0 &amp;nbsp   1 &amp;nbsp   2 &amp;nbsp   3 &amp;nbsp
    4 &amp;nbsp   5 &amp;nbsp   6 &amp;nbsp   7\r\n<br>a(n) &amp;nbsp   0 &amp;nbsp
    0 &amp;nbsp   0 &amp;nbsp   1 &amp;nbsp   0 &amp;nbsp   0 &amp;nbsp   1 &amp;nbsp
    2\r\n<br>b(n) &amp;nbsp   1 &amp;nbsp   1 &amp;nbsp   1 &amp;nbsp  -1 &amp;nbsp
    1 &amp;nbsp   1 &amp;nbsp  -1 &amp;nbsp   1\r\n<br>s(n) &amp;nbsp   1 &amp;nbsp
    2 &amp;nbsp   3 &amp;nbsp   2 &amp;nbsp   3 &amp;nbsp   4 &amp;nbsp   3 &amp;nbsp
    4</tt></p>\r\n\r\n<p>The sequence s(n) has the remarkable property that all elements
  are positive and every positive integer k occurs exactly k times.</p>\r\n\r\n<p>Define
  g(t,c), with 1 <img src=\"images/symbol_le.gif\" width=\"10\" height=\"12\" alt=\"≤\"
  border=\"0\" style=\"vertical-align:middle;\"> c <img src=\"images/symbol_le.gif\"
  width=\"10\" height=\"12\" alt=\"≤\" border=\"0\" style=\"vertical-align:middle;\">
  t, as the index in s(n) for which t occurs for the c'th time in s(n).\r\n<br>E.g.:
  g(3,3) = 6, g(4,2) = 7 and g(54321,12345) = 1220847710.</p>\r\n\r\n<p>Let F(n) be
  the fibonacci sequence defined by:\r\n<br>F(0)=F(1)=1 and\r\n<br>F(n)=F(n-1)+F(n-2)
  for n&gt;1.</p>\r\n\r\n<p>Define GF(t)=g(F(t),F(t-1)).</p>\r\n\r\n<p>Find ΣGF(t)
  for 2<img src=\"images/symbol_le.gif\" width=\"10\" height=\"12\" alt=\"≤\" border=\"0\"
  style=\"vertical-align:middle;\">t<img src=\"images/symbol_le.gif\" width=\"10\"
  height=\"12\" alt=\"≤\" border=\"0\" style=\"vertical-align:middle;\">45.</p>\r\n"
