---
:id: 396
:name: Weak Goodstein sequence
:url: http://projecteuler.net/problem=396
:content: "\r\n<p>\r\nFor any positive integer n, the <b>nth weak Goodstein sequence</b>
  {g<sub>1</sub>, g<sub>2</sub>, g<sub>3</sub>, ...} is defined as:\r\n</p>\n<ul>\n<li>
  g<sub>1</sub> = <var>n</var>\r\n</li>\n<li> for <var>k</var> <img src=\"images/symbol_gt.gif\"
  width=\"10\" height=\"10\" alt=\"&gt;\" border=\"0\" style=\"vertical-align:middle;\">
  1, g<sub><var>k</var></sub> is obtained by writing g<sub><var>k</var>-1</sub> in
  base <var>k</var>, interpreting it as a base <var>k</var> + 1 number, and subtracting
  1.\r\n</li>\n</ul>\r\nThe sequence terminates when g<sub><var>k</var></sub> becomes
  0.\r\n\r\n<p>\r\nFor example, the 6th weak Goodstein sequence is {6, 11, 17, 25,
  ...}:\r\n</p>\n<ul>\n<li> g<sub>1</sub> = 6.\r\n</li>\n<li> g<sub>2</sub> = 11 since
  6 = 110<sub>2</sub>, 110<sub>3</sub> = 12, and 12 - 1 = 11.\r\n</li>\n<li> g<sub>3</sub>
  = 17 since 11 = 102<sub>3</sub>, 102<sub>4</sub> = 18, and 18 - 1 = 17.\r\n</li>\n<li>
  g<sub>4</sub> = 25 since 17 = 101<sub>4</sub>, 101<sub>5</sub> = 26, and 26 - 1
  = 25.\r\n</li>\n</ul>\r\nand so on.\r\n\r\n<p>\r\nIt can be shown that every weak
  Goodstein sequence terminates.\r\n</p>\r\n<p>\r\nLet G(<var>n</var>) be the number
  of nonzero elements in the <var>n</var>th weak Goodstein sequence.<br>\r\nIt can
  be verified that G(2) = 3, G(4) = 21 and G(6) = 381.<br>\r\nIt can also be verified
  that ΣG(<var>n</var>) = 2517 for 1 <img src=\"images/symbol_le.gif\" width=\"10\"
  height=\"12\" alt=\"≤\" border=\"0\" style=\"vertical-align:middle;\"><var>n</var>
  <img src=\"images/symbol_lt.gif\" width=\"10\" height=\"10\" alt=\"&lt;\" border=\"0\"
  style=\"vertical-align:middle;\"> 8.\r\n</p>\r\n<p>\r\nFind the last 9 digits of
  ΣG(<var>n</var>) for 1 <img src=\"images/symbol_le.gif\" width=\"10\" height=\"12\"
  alt=\"≤\" border=\"0\" style=\"vertical-align:middle;\"><var>n</var> <img src=\"images/symbol_lt.gif\"
  width=\"10\" height=\"10\" alt=\"&lt;\" border=\"0\" style=\"vertical-align:middle;\">
  16.\r\n</p>\r\n"
